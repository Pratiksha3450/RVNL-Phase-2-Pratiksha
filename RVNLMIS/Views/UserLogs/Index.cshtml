@model IEnumerable<RVNLMIS.Models.UserLogsModel>
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";

}
<style type="text/css">
    #userlogs .card {
        margin-bottom: 10px;
    }

    .user_icon {
        height: 40px;
        width: 40px;
        padding: 12px;
        font-weight: 800;
        font-size: 16px;
        border-radius: 50%;
    }
</style>
<!-- [ Pre-loader ] start -->
<div class="loader-bg">
    <div class="loader-track">
        <div class="loader-fill"></div>
    </div>
</div>



<div id="userlogs">

    <!-- page contents -->

    <div class="row help-desk sm-view">
        <div class="col-xl-12 col-lg-12">
            <div class="card">
                <div class="card-body p-3">
                    <div class="row">
                        <div class="col-md-2  border-right">
                            <h6 class="text-right"><b>SEARCH BY DATE: </b></h6>
                        </div>
                        <div class="col-md-1">
                            <h6>From : </h6>
                        </div>
                        <div class="col-md-3">
                            @*<input type="text" name="datepicker_custom" value="10/24/1984" class="form-control datepicker2">*@
                            <input type="date" class="form-control" Value=@DateTime.Now.ToString("yyyy-MM-dd") id="txtFromDate">
                        </div>
                        <div class="col-md-1">
                            <h6 class="text-right">To : </h6>
                        </div>
                        <div class="col-md-3">
                            @*<input type="text" name="datepicker_custom" value="10/24/1984" class="form-control datepicker2">*@
                            <input type="date" class="form-control" Value=@DateTime.Now.ToString("yyyy-MM-dd") id="txtToDate">
                        </div>
                        <div class="col-md-2">
                            <button class="btn btn-sm btn_theme" id="btnSearch"> <i class="fas fa-search mr-1"></i> Search </button>

                        </div>
                    </div>
                </div>
            </div>
            <div class="ticket-block">
                <div class="row">
                    @*<div class="col-auto">
                    <span class="user_icon badge bg-light-green text-green"> @Html.DisplayFor(modelItem => item.Icon) </span>
                </div>*@
                    <div class="col">
                        <div class="card hd-body" style="background : #f9f0e0;">
                            <div class="row align-items-center">
                                <div class="col-2 left-icon border-right">
                                    <div class="card-body">
                                        <b class="float-right mr-3">Time</b>
                                        <b class="float-right mr-5">Date</b>
                                    </div>
                                </div>
                                @*<div class="col-1 col-auto pr-0 left-icon border-right">
                                    <div class="card-body">
                                        <b class="pt-2">User Name</b>
                                    </div>
                                </div>*@
                               
                                <div class="col-2 border-right pr-0">
                                    <div class="card-body inner-center">
                                        <b class="text-right"><b class="text-center"> </b> IP Address</b>
                                    </div>
                                </div>
                               
                                <div class="col-3 border-right pr-0">
                                    <div class="card-body inner-center">
                                        <b class="text-right"> Form Name </b>
                                    </div>
                                </div>
                                <div class="col-1 border-right pr-0">
                                    <div class="card-body inner-center">

                                        <b class="text-right"> Action </b>
                                    </div>
                                </div>
                                <div class="col-4 border-right pr-0">
                                    <div class="card-body inner-center">
                                        <b class="text-right"> Field Name </b>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="DivLogs">
                @if (Model != null)
                {

                    foreach (var item in Model)
                    {
                        <div class="ticket-block">
                            <div class="row">
                                @*<div class="col-auto">
                                <span class="user_icon badge bg-light-green text-green"> @Html.DisplayFor(modelItem => item.Icon) </span>
                            </div>*@
                                <div class="col">
                                    <div class="card hd-body">
                                        <div class="row align-items-center">
                                            <div class="col-2 left-icon border-right">
                                                <div class="card-body">
                                                    <b class="float-right ml-3 text-magenta">@Html.DisplayFor(modelItem => item.AccessedTime)</b>
                                                    <b class="float-right">@Html.DisplayFor(modelItem => item.AccessedDate)</b>
                                                </div>
                                            </div>
                                            @*<div class="col-1 col-auto pr-0 left-icon border-right">
                                                <div class="card-body">
                                                    <h6 class="pt-2">@Html.DisplayFor(modelItem => item.Name)</h6>
                                                </div>
                                            </div>*@
                                           
                                            <div class="col-2 border-right pr-0">
                                                <div class="card-body inner-center">
                                                    <span class="text-right"> @Html.DisplayFor(modelItem => item.IPAddress)</span>
                                                </div>
                                            </div>
                                          
                                            <div class="col-3 border-right pr-0">
                                                <div class="card-body inner-center">
                                                    <div class="ticket-type-icon private mt-1 mb-1">
                                                        <i class="fas fa-window-restore mr-1 f-16 text-magenta"></i>
                                                        @Html.DisplayFor(modelItem => item.FormName)
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-1 border-right pr-0">
                                                <div class="card-body inner-center">
                                                    <div class="ticket-type-icon private mt-1 mb-1">
                                                        <i class="fas fa-user-cog mr-1 f-16 text-magenta"></i>
                                                        @Html.DisplayFor(modelItem => item.ActionDone)
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-4 border-right pr-0">
                                                <div class="card-body inner-center">
                                                    <div class="ticket-type-icon private mt-1 mb-1">                                                        
                                                        @Html.DisplayFor(modelItem => item.UpdatedValue)
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    }
                }
            </div>
        </div>
    </div>
</div>

@section scripts{
    <!-- /Required Js -->
    <!-- prism Js -->
    <script src="~/Content/assets/js/plugins/prism.js"></script>
    <!-- Lightbox Js -->
    <script src="~/Content/assets/js/plugins/ekko-lightbox.min.js"></script>
    <script src="~/Content/assets/js/plugins/lightbox.min.js"></script>
    <script src="~/Content/assets/js/pages/ac-lightbox.js"></script>

    <script src="~/Content/assets/js/plugins/trumbowyg.min.js"></script>


    <!-- custom-data js -->
    <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js"></script>
    <script src="http://maps.google.com/maps/api/js?key=AIzaSyDsucrEdmswqYrw0f6ej3bf4M4suDeRgNA"></script>


    <!-- select2 Js -->
    <script src="~/Content/assets/js/plugins/select2.full.min.js"></script>
    <!-- form-select-custom Js -->
    <script src="~/Content/assets/js/pages/form-select-custom.js"></script>


    <!-- Horizontal Menu -->

    <script src="~/Content/assets/js/horizontal-menu.js"></script>

    <script>
        (function () {
            if ($('#layout-sidenav').hasClass('sidenav-horizontal') || window.layoutHelpers.isSmallScreen()) {
                return;
            }
            try {
                window.layoutHelpers._getSetting("Rtl")
                window.layoutHelpers.setCollapsed(
                    localStorage.getItem('layoutCollapsed') === 'true',
                    false
                );
            } catch (e) { }
        })();
        $(function () {
            $('#layout-sidenav').each(function () {
                new SideNav(this, {
                    orientation: $(this).hasClass('sidenav-horizontal') ? 'horizontal' : 'vertical'
                });
            });
            $('body').on('click', '.layout-sidenav-toggle', function (e) {
                e.preventDefault();
                window.layoutHelpers.toggleCollapsed();
                if (!window.layoutHelpers.isSmallScreen()) {
                    try {
                        localStorage.setItem('layoutCollapsed', String(window.layoutHelpers.isCollapsed()));
                    } catch (e) { }
                }
            });
        });
        $(document).ready(function () {

           
            //$('#txtFromDate').attr('min', -3M);
            //$('#txtToDate').attr('max', new Date());



            $("#pcoded").pcodedmenu({
                themelayout: 'horizontal',
                MenuTrigger: 'hover',
                SubMenuTrigger: 'hover',
            });
        });
    </script>

    <!-- /Horizontal Menu -->
    <!--  -->
    <script>
        $(window).on('load', function () {
            $('#tinymce-editor').trumbowyg({
                svgPath: '~/Content/assets/css/plugins/icons.svg',
                btns: [
                    ['viewHTML'],
                    ['undo', 'redo'],
                    ['formatting'],
                    ['strong', 'em', 'del'],
                    ['superscript', 'subscript'],
                    ['link'],
                    ['insertImage'],
                    ['unorderedList', 'orderedList'],
                    ['horizontalRule'],
                    ['removeformat'],
                    ['fullscreen']
                ]
            });
        });
        $(document).ready(function () {
            $(".show-timeline").click(function () {
                $(".q-view").addClass("active");
            });
            $(".overlay").click(function () {
                $(".q-view").removeClass("active");
            });
        });

        $(document).ready(function () {
            $(document).on('click', '[data-toggle="lightbox"]', function (event) {
                event.preventDefault();
                $(this).ekkoLightbox();
            });
        });

        $(document).ready(function () {


            // debugger;
            //$("#txtFromDate").datepicker();
            //$("#txtFromDate").datepicker("setDate", startDate);
            //setTimeout(function () {
            //    debugger;

            //    var d = new Date();
            //    var currMonth = d.getMonth();
            //    var currentDate = d.getDate();
            //    var currYear = d.getFullYear();
            //    var startDate = new Date(currYear, currMonth, currentDate - 3);
            //    var endDate = new Date(currYear, currMonth, currentDate);
            //   // alert(formatDate(startDate));
            //    $('#txtFromDate').attr('min', formatDate(startDate));
            //    $('#txtFromDate').attr('max', formatDate(endDate));

            //    $('#txtToDate').attr('min', formatDate(startDate));
            //    $('#txtToDate').attr('max', formatDate(endDate));

            //}, 500);


            function formatDate(date) {
                var d = new Date(date),
                    month = '' + (d.getMonth() + 1),
                    day = '' + d.getDate(),
                    year = d.getFullYear();

                if (month.length < 2)
                    month = '0' + month;
                if (day.length < 2)
                    day = '0' + day;

                return [year, month, day].join('-');
            }

            $("#txtFromDate").on('change', function () {
                debugger;
                var d = $("#txtFromDate").val();               
                var end_date = moment(d).clone().add(3, 'days');
                //var currMonth = d.getMonth();
                //var currentDate = d.getDate();
                //var currYear = d.getFullYear();
                //var startDate = new Date(currYear, currMonth, currentDate - 3);
               // var endDate = new Date(currYear, currMonth, currentDate);
                $('#txtToDate').attr('min', d);
                $('#txtToDate').attr('max', formatDate(end_date));
                $('#txtToDate').val(formatDate(end_date));
                });

            $("#btnSearch").click(function () {
                $(".se-pre-con").show();
                //alert('Clicked!');
                var formData = new FormData();
                formData.append("fromDate", $("#txtFromDate").val());
                formData.append("toDate", $("#txtToDate").val());
                $.ajax({
                    url: '/UserLogs/GetLogsDatewise',
                    type: "POST",
                    cache: false,
                    contentType: false,
                    processData: false,
                    data: formData,
                    success: function (response) {
                        $("#DivLogs").html(response);
                        $(".se-pre-con").hide();
                    }
                      
                });
            });

        });
    </script>
    <!-- / -->
    <script src="~/Content/assets/js/analytics.js"></script>


    <!-- Show hide div on radio selection -->
    <script>

        function show1() {
            document.getElementById('div0').style.display = 'block';
            document.getElementById('div1').style.display = 'block';
            document.getElementById('div2').style.display = 'none';
            document.getElementById('div3').style.display = 'none';
        }
        function show2() {
            document.getElementById('div0').style.display = 'none';
            document.getElementById('div1').style.display = 'none';
            document.getElementById('div2').style.display = 'block';
            document.getElementById('div3').style.display = 'none';
        }
        function show3() {
            document.getElementById('div0').style.display = 'none';
            document.getElementById('div1').style.display = 'none';
            document.getElementById('div2').style.display = 'none';
            document.getElementById('div3').style.display = 'block';
        }
    </script>
   
    <script>
        function show_enclosureform() {

            var customCheck1 = document.getElementById("customCheck1");
            var enclosureform = document.getElementById("enclosureform");

            if (customCheck1.checked) {
                enclosureform.style.display = "block";
            } else {
                enclosureform.style.display = "none";
            }
        }


        function show_inspectionform() {

            var customCheck2 = document.getElementById("addinspectiondetails");
            var inspectionform = document.getElementById("inspectionform");

            if (customCheck2.checked) {
                inspectionform.style.display = "block";
            } else {
                inspectionform.style.display = "none";
            }
        }
      
    </script>

}
